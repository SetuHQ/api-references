{
  "openapi": "3.0.0",
  "servers": [
    { "url": "http://example.com", "description": "", "variables": {} }
  ],
  "info": {
    "version": "46118b01-da07-4f47-b719-97ced4acafae",
    "title": "FIU service - public",
    "description": "",
    "termsOfService": "",
    "contact": {},
    "license": { "name": "" }
  },
  "paths": {
    "/consents": {
      "post": {
        "summary": "Create new consent",
        "description": "Call this API to create a consent request. Update Customer.id with your mobile number to be able to test the flow. This API responds with a **url** to initiate consent review flow as part of the response, with consent status as PENDING.  \nRead more about Consent Review by Customer here(https://docs.setu.co/data/account-aggregator/api-integration/consent-flow#consent-review-by-customer)",
        "operationId": "Createnewconsent",
        "parameters": [
          { "$ref": "#/components/parameters/x-client-id" },
          { "$ref": "#/components/parameters/x-client-secret" }
        ],
        "responses": { "200": { "description": "", "headers": {} } },
        "requestBody": {
          "description": "Call this API to create a consent request. Update Customer.id with your mobile number to be able to test the flow. This API responds with a **url** to initiate consent review flow as part of the response, with consent status as PENDING.  \nRead more about Consent Review by Customer here(https://docs.setu.co/data/account-aggregator/api-integration/consent-flow#consent-review-by-customer)",
          "required": true,
          "content": {
            "text/plain": {
              "schema": {
                "type": "string",
                "example": {
                  "Detail": {
                    "consentStart": "{{$isoTimestamp}}",
                    "consentExpiry": "2022-04-23T05:44:53.822Z",
                    "Customer": { "id": "{{mobile_number}}@onemoney" },
                    "FIDataRange": {
                      "from": "2021-04-01T00:00:00Z",
                      "to": "2021-10-01T00:00:00Z"
                    },
                    "consentMode": "STORE",
                    "consentTypes": ["TRANSACTIONS", "PROFILE", "SUMMARY"],
                    "fetchType": "PERIODIC",
                    "Frequency": { "value": 30, "unit": "MONTH" },
                    "DataFilter": [
                      {
                        "type": "TRANSACTIONAMOUNT",
                        "value": "5000",
                        "operator": ">="
                      }
                    ],
                    "DataLife": { "value": 1, "unit": "MONTH" },
                    "DataConsumer": { "id": "setu-fiu-id" },
                    "Purpose": {
                      "Category": { "type": "string" },
                      "code": "101",
                      "text": "Loan underwriting",
                      "refUri": "https://api.rebit.org.in/aa/purpose/101.xml"
                    },
                    "fiTypes": ["DEPOSIT"]
                  },
                  "redirectUrl": "https://setu.co"
                }
              },
              "example": "{\n    \"Detail\": {\n        \"consentStart\": \"{{$isoTimestamp}}\",\n        \"consentExpiry\": \"2022-04-23T05:44:53.822Z\",\n        \"Customer\": {\n            \"id\": \"{{mobile_number}}@onemoney\"\n        },\n        \"FIDataRange\": {\n            \"from\": \"2021-04-01T00:00:00Z\",\n            \"to\": \"2021-10-01T00:00:00Z\"\n        },\n        \"consentMode\": \"STORE\",\n        \"consentTypes\": [\n            \"TRANSACTIONS\",\n            \"PROFILE\",\n            \"SUMMARY\"\n        ],\n        \"fetchType\": \"PERIODIC\",\n        \"Frequency\": {\n            \"value\": 30,\n            \"unit\": \"MONTH\"\n        },\n        \"DataFilter\": [\n            {\n                \"type\": \"TRANSACTIONAMOUNT\",\n                \"value\": \"5000\",\n                \"operator\": \">=\"\n            }\n        ],\n        \"DataLife\": {\n            \"value\": 1,\n            \"unit\": \"MONTH\"\n        },\n        \"DataConsumer\": {\n            \"id\": \"setu-fiu-id\"\n        },\n        \"Purpose\": {\n            \"Category\": {\n                \"type\": \"string\"\n            },\n            \"code\": \"101\",\n            \"text\": \"Loan underwriting\",\n            \"refUri\": \"https://api.rebit.org.in/aa/purpose/101.xml\"\n        },\n        \"fiTypes\": [\n            \"DEPOSIT\"\n        ]\n    },\n    \"redirectUrl\": \"https://setu.co\"\n}"
            }
          }
        },
        "tags": ["Consent APIs"]
      }
    },
    "/consents/{id}": {
      "get": {
        "summary": "Get a consent",
        "description": "Call this API to get the updated status of a consent request by passing its unique `id`. If the consent is approved, the Status in the response will be `ACTIVE`. After this, you can now initiate Data flow for the approved consent request.",
        "operationId": "Getaconsent",
        "parameters": [
          {
            "name": "x-client-id",
            "in": "header",
            "required": true,
            "style": "simple",
            "schema": { "type": "string", "example": "{{client_id}}" }
          },
          {
            "name": "x-client-secret",
            "in": "header",
            "required": true,
            "style": "simple",
            "schema": { "type": "string", "example": "{{client_secret}}" }
          },
          { "$ref": "#/components/parameters/id" }
        ],
        "responses": { "200": { "description": "", "headers": {} } },
        "tags": ["Consent APIs"]
      }
    },
    "/sessions": {
      "post": {
        "summary": "Create new data session",
        "description": "Call this API to create a data session against the approved `consentId`. Specify the format in which you wish to receive the decrypted financial data, this can be **xml** or **json.** Make sure that values of `DataRange` array in the body, matches or is within the `FIDataRange` specified in the Create consent request API.",
        "operationId": "Createnewdatasession",
        "parameters": [
          {
            "name": "x-client-id",
            "in": "header",
            "required": true,
            "style": "simple",
            "schema": { "type": "string", "example": "{{client_id}}" }
          },
          {
            "name": "x-client-secret",
            "in": "header",
            "required": true,
            "style": "simple",
            "schema": { "type": "string", "example": "{{client_secret}}" }
          }
        ],
        "responses": { "200": { "description": "", "headers": {} } },
        "requestBody": {
          "description": "Call this API to create a data session against the approved `consentId`. Specify the format in which you wish to receive the decrypted financial data, this can be **xml** or **json.** Make sure that values of `DataRange` array in the body, matches or is within the `FIDataRange` specified in the Create consent request API.",
          "required": true,
          "content": {
            "text/plain": {
              "schema": {
                "type": "string",
                "example": {
                  "consentId": "{{consent_request_id}}",
                  "DataRange": {
                    "from": "2021-04-01T00:00:00Z",
                    "to": "2021-09-30T00:00:00Z"
                  },
                  "format": "json"
                }
              },
              "example": "{\n  \"consentId\": \"{{consent_request_id}}\",\n  \"DataRange\": {\n    \"from\": \"2021-04-01T00:00:00Z\",\n    \"to\": \"2021-09-30T00:00:00Z\"\n  },\n  \"format\": \"json\"\n}"
            }
          }
        },
        "tags": ["Data session APIs"]
      }
    },
    "/sessions/{id}": {
      "get": {
        "summary": "Get data",
        "description": "The notification URL you have configured with Setu will be used to notify you when data is ready to be fetched. Then, use the `id` received in Create Data Session API in the previous step to call this API to fetch the financial information of your user.",
        "operationId": "Getdata",
        "parameters": [
          {
            "name": "x-client-id",
            "in": "header",
            "required": true,
            "style": "simple",
            "schema": { "type": "string", "example": "{{client_id}}" }
          },
          {
            "name": "x-client-secret",
            "in": "header",
            "required": true,
            "style": "simple",
            "schema": { "type": "string", "example": "{{client_secret}}" }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "style": "simple",
            "schema": { "type": "string", "example": "id" }
          }
        ],
        "responses": { "200": { "description": "", "headers": {} } },
        "tags": ["Data session APIs"]
      }
    }
  },
  "components": {
    "parameters": {
      "x-client-id": {
        "name": "x-client-id",
        "in": "header",
        "required": true,
        "style": "simple",
        "schema": { "type": "string", "example": "{{client_id}}" }
      },
      "x-client-secret": {
        "name": "x-client-secret",
        "in": "header",
        "required": true,
        "style": "simple",
        "schema": { "type": "string", "example": "{{client_secret}}" }
      },
      "id": {
        "name": "id",
        "in": "path",
        "required": true,
        "style": "simple",
        "schema": { "type": "string", "example": "id" }
      }
    }
  },
  "security": [],
  "tags": [],
  "externalDocs": { "url": "", "description": "" },
  "warnings": []
}
